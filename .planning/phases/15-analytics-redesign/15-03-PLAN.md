---
phase: 15-analytics-redesign
plan: 03
type: execute
wave: 2
depends_on: ["15-01"]
files_modified:
  - src/components/analytics/TimeRangePicker.tsx
  - src/components/analytics/SummaryStatsCards.tsx
  - src/components/analytics/VolumeLegend.tsx
  - src/components/analytics/SectionHeading.tsx
autonomous: true

must_haves:
  truths:
    - "TimeRangePicker renders 5 pill buttons (1M/3M/6M/1Y/All) with active state styling"
    - "SummaryStatsCards shows 4 compact stat cards in 2x2 grid"
    - "VolumeLegend explains all 5 zones with color swatches and MEV/MAV/MRV definitions with citation"
    - "SectionHeading renders h2 with divider line, replacing CollapsibleSection"
  artifacts:
    - path: "src/components/analytics/TimeRangePicker.tsx"
      provides: "Time range pill selector component"
      contains: "TimeRangePicker"
    - path: "src/components/analytics/SummaryStatsCards.tsx"
      provides: "2x2 summary stats grid"
      contains: "SummaryStatsCards"
    - path: "src/components/analytics/VolumeLegend.tsx"
      provides: "5-zone volume legend with citation (ANLT-04)"
      contains: "Schoenfeld"
    - path: "src/components/analytics/SectionHeading.tsx"
      provides: "Section heading with divider"
      contains: "SectionHeading"
  key_links:
    - from: "src/components/analytics/VolumeLegend.tsx"
      to: "src/index.css"
      via: "OKLCH chart-zone tokens"
      pattern: "chart-zone-optimal"
    - from: "src/components/analytics/TimeRangePicker.tsx"
      to: "src/types/analytics.ts"
      via: "TimeRange type import"
      pattern: "TimeRange"
---

<objective>
Create the 4 new UI components needed for the analytics dashboard: TimeRangePicker, SummaryStatsCards, VolumeLegend, and SectionHeading.

Purpose: These are self-contained presentational components that can be built independently from hook parameterization (Plan 02). They will be assembled into the dashboard in Plan 05.
Output: 4 new React components in src/components/analytics/, all using OKLCH tokens and Tailwind v4 classes.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/15-analytics-redesign/15-CONTEXT.md
@.planning/phases/15-analytics-redesign/15-RESEARCH.md
@src/types/analytics.ts
@src/index.css
@src/components/analytics/AnalyticsPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TimeRangePicker and SectionHeading components</name>
  <files>src/components/analytics/TimeRangePicker.tsx, src/components/analytics/SectionHeading.tsx</files>
  <action>
**TimeRangePicker.tsx** — Pill selector for time range:

```typescript
import type { TimeRange } from '../../types/analytics';

interface TimeRangePickerProps {
  value: TimeRange;
  onChange: (range: TimeRange) => void;
}

const OPTIONS: TimeRange[] = ['1M', '3M', '6M', '1Y', 'ALL'];

export function TimeRangePicker({ value, onChange }: TimeRangePickerProps) {
  return (
    <div className="flex gap-2" role="group" aria-label="Time range">
      {OPTIONS.map((option) => (
        <button
          key={option}
          onClick={() => onChange(option)}
          aria-pressed={value === option}
          className={`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${
            value === option
              ? 'bg-accent text-white'
              : 'bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-elevated'
          }`}
        >
          {option}
        </button>
      ))}
    </div>
  );
}
```

Include `role="group"` and `aria-pressed` for accessibility. Use the existing `bg-accent` token for the active pill. The inactive state uses `bg-bg-tertiary` for subtle contrast.

**SectionHeading.tsx** — Replaces CollapsibleSection for flat layout:

```typescript
interface SectionHeadingProps {
  title: string;
  subtitle?: string;
}

export function SectionHeading({ title, subtitle }: SectionHeadingProps) {
  return (
    <div className="border-t border-border-primary pt-6 mt-2">
      <h2 className="text-lg font-semibold text-text-primary">{title}</h2>
      {subtitle && (
        <p className="text-sm text-text-muted mt-1">{subtitle}</p>
      )}
    </div>
  );
}
```

Simple h2 + optional subtitle + top border divider. Uses `text-lg` (not `text-xl`) to keep it compact.
  </action>
  <verify>Run `npx tsc --noEmit` to confirm both files have no type errors.</verify>
  <done>TimeRangePicker renders 5 pills with active state. SectionHeading renders h2 + divider. Both export correctly.</done>
</task>

<task type="auto">
  <name>Task 2: Create SummaryStatsCards and VolumeLegend components</name>
  <files>src/components/analytics/SummaryStatsCards.tsx, src/components/analytics/VolumeLegend.tsx</files>
  <action>
**SummaryStatsCards.tsx** — 2x2 grid of summary stat cards:

```typescript
import type { SummaryStats } from '../../types/analytics';

interface SummaryStatsCardsProps {
  stats: SummaryStats;
  isLoading?: boolean;
}

export function SummaryStatsCards({ stats, isLoading }: SummaryStatsCardsProps) {
  const cards = [
    { label: 'Workouts', value: stats.totalWorkouts },
    { label: 'Volume', value: stats.totalVolumeKg >= 1000
        ? `${(stats.totalVolumeKg / 1000).toFixed(1)}t`
        : `${Math.round(stats.totalVolumeKg)}kg` },
    { label: 'PRs Hit', value: stats.totalPrs },
    { label: 'Streak', value: `${stats.streakWeeks}wk` },
  ];

  if (isLoading) {
    return (
      <div className="grid grid-cols-2 gap-3">
        {[0, 1, 2, 3].map((i) => (
          <div key={i} className="bg-bg-secondary border border-border-primary rounded-lg p-4 animate-pulse">
            <div className="h-7 w-16 bg-bg-tertiary rounded mb-2" />
            <div className="h-4 w-12 bg-bg-tertiary rounded" />
          </div>
        ))}
      </div>
    );
  }

  return (
    <div className="grid grid-cols-2 gap-3">
      {cards.map((card) => (
        <div key={card.label} className="bg-bg-secondary border border-border-primary rounded-lg p-4">
          <div className="text-2xl font-bold text-text-primary">{card.value}</div>
          <div className="text-sm text-text-secondary mt-1">{card.label}</div>
        </div>
      ))}
    </div>
  );
}
```

Include a skeleton loading state with `animate-pulse` placeholders. Volume displays as tonnes when >= 1000kg.

**VolumeLegend.tsx** — 5-zone legend with MEV/MAV/MRV explanation and citation (ANLT-04):

```typescript
export function VolumeLegend() {
  const zones = [
    { token: 'var(--color-chart-zone-under)', label: 'Under MEV', desc: 'Not enough stimulus for growth' },
    { token: 'var(--color-chart-zone-minimum)', label: 'MEV-MAV', desc: 'Minimum effective volume' },
    { token: 'var(--color-chart-zone-optimal)', label: 'MAV Range', desc: 'Optimal growth zone' },
    { token: 'var(--color-chart-zone-high)', label: 'MAV-MRV', desc: 'High volume, approaching limit' },
    { token: 'var(--color-chart-zone-over)', label: 'Over MRV', desc: 'Exceeding recovery capacity' },
  ];

  return (
    <div className="bg-bg-secondary rounded-lg p-4 space-y-3">
      <h4 className="text-sm font-medium text-text-primary">Volume Zones</h4>
      <div className="flex flex-wrap gap-x-4 gap-y-2">
        {zones.map((zone) => (
          <div key={zone.label} className="flex items-center gap-2">
            <div
              className="w-3 h-3 rounded-sm shrink-0"
              style={{ backgroundColor: zone.token }}
            />
            <span className="text-xs text-text-secondary">
              <span className="font-medium">{zone.label}</span> — {zone.desc}
            </span>
          </div>
        ))}
      </div>
      <p className="text-xs text-text-muted pt-2 border-t border-border-primary">
        MEV = Minimum Effective Volume, MAV = Maximum Adaptive Volume, MRV = Maximum Recoverable Volume.
        Based on Schoenfeld et al. (2017) and Renaissance Periodization guidelines.
      </p>
    </div>
  );
}
```

The citation line at the bottom fulfills ANLT-04. Color swatches use the OKLCH `--color-chart-zone-*` tokens from Plan 01's CSS update. Use `shrink-0` on color swatches to prevent them from collapsing on narrow screens.
  </action>
  <verify>Run `npx tsc --noEmit` to confirm both files have no type errors. Run `npm run build`.</verify>
  <done>SummaryStatsCards renders 2x2 grid with skeleton loading state. VolumeLegend shows all 5 zones with MEV/MAV/MRV definitions and Schoenfeld citation.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- `npm run build` succeeds
- All 4 new components exist and export correctly
- VolumeLegend contains "Schoenfeld" citation text (ANLT-04)
- TimeRangePicker accepts TimeRange type
- SummaryStatsCards accepts SummaryStats type
</verification>

<success_criteria>
- TimeRangePicker: 5 pills render, active pill highlighted with accent color, accessible role/aria attributes
- SummaryStatsCards: 2x2 grid of stat cards, handles loading skeleton, formats volume in tonnes when >= 1000kg
- VolumeLegend: 5 color-coded zones with labels, descriptions, and Schoenfeld/RP citation (ANLT-04 complete)
- SectionHeading: h2 + subtitle + top border divider
- All components use OKLCH tokens (no hardcoded HSL colors)
</success_criteria>

<output>
After completion, create `.planning/phases/15-analytics-redesign/15-03-SUMMARY.md`
</output>
