---
phase: 22-bug-fixes-theme
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/rotation/QuickStartCard.tsx
  - src/components/workout/StartWorkout.tsx
  - src/index.css
autonomous: true

must_haves:
  truths:
    - "Quick Start no longer shows 'plan or gym not found' when default gym and rotation exist"
    - "All OKLCH tokens in index.css define a cool blue/teal palette with neutral backgrounds"
    - "Legacy HSL tokens are removed from index.css"
  artifacts:
    - path: "src/index.css"
      provides: "Complete teal OKLCH color system"
      contains: "oklch.*185"
    - path: "src/components/rotation/QuickStartCard.tsx"
      provides: "Fixed planId property access"
      contains: "nextPlan.planId"
    - path: "src/components/workout/StartWorkout.tsx"
      provides: "Fixed planId property access"
      contains: "nextPlan?.planId"
  key_links:
    - from: "src/components/rotation/QuickStartCard.tsx"
      to: "useRotationStore selectNextPlan"
      via: "nextPlan.planId property"
      pattern: "nextPlan\\.planId"
---

<objective>
Fix the rotation bug (templateId->planId) and overhaul all color tokens in index.css from warm orange to cool blue/teal.

Purpose: Establishes the new color foundation that propagates to all 44+ files using Tailwind accent classes, and fixes the blocking Quick Start bug.
Output: Working Quick Start flow, complete teal token system in index.css.
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-bug-fixes-theme/22-CONTEXT.md
@.planning/phases/22-bug-fixes-theme/22-RESEARCH.md
@src/index.css
@src/components/rotation/QuickStartCard.tsx
@src/components/workout/StartWorkout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix rotation templateId->planId bug</name>
  <files>src/components/rotation/QuickStartCard.tsx, src/components/workout/StartWorkout.tsx</files>
  <action>
In QuickStartCard.tsx, replace all 3 occurrences of `nextPlan.templateId` with `nextPlan.planId`:
- `plans.find(t => t.template_id === nextPlan.templateId)` -> `plans.find(t => t.template_id === nextPlan.planId)`
- `editPlanId || nextPlan.templateId` -> `editPlanId || nextPlan.planId`
- `setEditPlanId(nextPlan.templateId)` -> `setEditPlanId(nextPlan.planId)`

In StartWorkout.tsx, replace the 1 occurrence:
- `nextPlan?.templateId` -> `nextPlan?.planId`

Do NOT change the `selectNextPlan` selector or any store code. The selector already returns `{ planId }` — the consumers were out of date.
  </action>
  <verify>Run `grep -r "templateId" src/components/rotation/QuickStartCard.tsx src/components/workout/StartWorkout.tsx` — should return zero results. Run `npx tsc --noEmit` — should pass with zero errors.</verify>
  <done>QuickStartCard and StartWorkout both use `nextPlan.planId`. No references to `templateId` remain in these two files.</done>
</task>

<task type="auto">
  <name>Task 2: Overhaul index.css color tokens to blue/teal palette</name>
  <files>src/index.css</files>
  <action>
Replace the entire `@theme {}` block color system in `src/index.css` with cool blue/teal tokens. Keep typography, font, and non-color tokens unchanged.

**Background layers** — neutral/cool dark gray (hue ~220, very low chroma ~0.005):
```css
--color-bg-primary: oklch(15% 0.005 220);       /* page background ~#111 */
--color-bg-secondary: oklch(19% 0.005 220);     /* card backgrounds */
--color-bg-tertiary: oklch(24% 0.005 220);      /* input backgrounds, hover states */
--color-bg-elevated: oklch(27% 0.005 220);      /* elevated surfaces, active states */
```

**Text hierarchy** — pure/cool whites (zero chroma for neutral Apple-style):
```css
--color-text-primary: oklch(93% 0 0);           /* pure white primary */
--color-text-secondary: oklch(70% 0 0);         /* ~60% secondary */
--color-text-muted: oklch(55% 0 0);             /* ~30% muted, WCAG AA against bg-primary */
```

**Borders** — cool neutral:
```css
--color-border-primary: oklch(25% 0.005 220);   /* subtle card borders */
--color-border-secondary: oklch(36% 0.005 220); /* focus states */
```

**Accent** — soft muted teal (hue 185, moderate chroma):
```css
--color-accent: oklch(68% 0.10 185);            /* primary teal */
--color-accent-hover: oklch(60% 0.09 185);      /* hover/pressed */
--color-accent-muted: oklch(68% 0.04 185);      /* subtle accent backgrounds */
```
Note: L=68% is light enough to keep `text-black` readable on accent backgrounds (contrast ratio ~5:1).

**Semantic colors** — keep standard green/red/yellow, unchanged:
```css
--color-success: oklch(65% 0.17 145);
--color-error: oklch(63% 0.22 25);
--color-warning: oklch(75% 0.15 85);
```

**Chart colors** — teal-aligned:
```css
--color-chart-primary: oklch(65% 0.10 185);     /* teal primary series */
--color-chart-success: oklch(62% 0.15 145);     /* green - 1RM (unchanged) */
--color-chart-muted: oklch(50% 0.005 220);      /* cool gray axes/grid */
```

**Volume zone teal gradient** (light=under, medium=optimal, dark=over):
```css
--color-chart-zone-under: oklch(80% 0.08 185);
--color-chart-zone-minimum: oklch(70% 0.10 185);
--color-chart-zone-optimal: oklch(60% 0.12 185);
--color-chart-zone-high: oklch(48% 0.10 185);
--color-chart-zone-over: oklch(38% 0.08 185);
```

**Chart tooltip** — cool dark:
```css
--color-chart-tooltip-bg: oklch(13% 0.005 220);
--color-chart-tooltip-border: oklch(20% 0.005 220);
```

**Remove all 4 legacy HSL tokens** (`--chart-primary`, `--chart-success`, `--chart-muted`, `--accent`). They will be replaced by OKLCH references in Plan 02.

**Border radius** — reduce to Apple-subtle 10-12px:
```css
--radius-sm: 0.375rem;   /* 6px */
--radius-md: 0.625rem;   /* 10px */
--radius-lg: 0.75rem;    /* 12px */
```

**Shadows** — reduce to minimal (rely on surface color for depth):
```css
--shadow-card: 0 1px 4px oklch(0% 0 0 / 0.15), 0 0.5px 2px oklch(0% 0 0 / 0.1);
--shadow-card-hover: 0 2px 8px oklch(0% 0 0 / 0.2), 0 1px 3px oklch(0% 0 0 / 0.12);
--shadow-dialog: 0 4px 16px oklch(0% 0 0 / 0.3), 0 2px 6px oklch(0% 0 0 / 0.15);
--shadow-nav: 0 -1px 4px oklch(0% 0 0 / 0.12);
```

**Gradient** — cool tint:
```css
--gradient-card-surface: linear-gradient(to bottom, oklch(21% 0.005 220), oklch(19% 0.005 220));
```

Update the `@theme {}` block header comment from "warm dark theme" to "cool teal theme (Apple dark mode aesthetic)".
  </action>
  <verify>Run `grep "oklch.*45)" src/index.css` — should return zero results (no orange hue 45 remnants). Run `grep "hsl\|--accent:" src/index.css` — should return zero results (no legacy HSL). Run `grep "oklch.*185" src/index.css` — should return multiple teal-hued results. Run `npx vite build` — should succeed with no CSS errors.</verify>
  <done>index.css contains only cool blue/teal OKLCH tokens. No orange (hue 45), no legacy HSL variables. Background hues are ~220, accent hue is 185. Border radius reduced to 6/10/12px. Shadows are minimal.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npx vite build` succeeds (no CSS parse errors from token changes)
3. No orange hue (45) in index.css: `grep "oklch.*0\.\(1[5-9]\|2\).*45)" src/index.css` returns empty
4. No legacy HSL tokens: `grep -E "^\s*--(accent|chart-)" src/index.css` returns empty
5. Teal accent present: `grep "185" src/index.css` returns multiple lines
</verification>

<success_criteria>
- QuickStartCard.tsx and StartWorkout.tsx use `nextPlan.planId` (not templateId)
- index.css defines a complete cool teal color system with no warm/orange remnants
- Legacy HSL variables removed
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/22-bug-fixes-theme/22-01-SUMMARY.md`
</output>
