---
phase: 09-batch-logging-visual-polish
plan: 03
type: execute
wave: 2
depends_on: []
files_modified:
  - package.json
  - src/App.tsx
  - src/components/Navigation.tsx
  - src/components/GymList.tsx
  - src/components/ExerciseList.tsx
  - src/components/ExerciseForm.tsx
  - src/components/GymForm.tsx
  - src/components/DeleteConfirmation.tsx
  - src/components/templates/TemplateList.tsx
  - src/components/templates/TemplateCard.tsx
  - src/components/templates/TemplateBuilder.tsx
  - src/components/backup/BackupSettings.tsx
  - src/components/backup/BackupReminder.tsx
autonomous: true

must_haves:
  truths:
    - "All screens use design token classes (bg-bg-primary, text-text-primary, etc.) instead of raw zinc classes"
    - "Page transitions animate with subtle slide/fade when switching tabs"
    - "Navigation, headers, cards, buttons, and inputs all follow consistent visual language"
  artifacts:
    - path: "src/App.tsx"
      provides: "AnimatePresence wrapper around tab content for page transitions"
    - path: "src/components/Navigation.tsx"
      provides: "Navigation using design token colors"
  key_links:
    - from: "src/App.tsx"
      to: "framer-motion"
      via: "LazyMotion + AnimatePresence wrapping tab content"
      pattern: "AnimatePresence|LazyMotion|motion|framer-motion"
    - from: "all migrated components"
      to: "design tokens"
      via: "Tailwind classes using design token names"
      pattern: "bg-bg-|text-text-|border-border-|text-accent|bg-accent"
---

<objective>
Install framer-motion, add page transitions between tabs, and migrate all screens to consistent design token usage. Every screen should feel like the same app with a dark, modern aesthetic.

Purpose: Visual polish (UI-03, UI-04) gives the app a professional, cohesive feel. Design tokens from Phase 8 exist but many components still use raw zinc/hardcoded colors.
Output: Consistent visual design across all screens, smooth tab transitions
</objective>

<execution_context>
@/home/dev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-batch-logging-visual-polish/09-CONTEXT.md
@.planning/phases/09-batch-logging-visual-polish/09-RESEARCH.md

@src/App.tsx
@src/index.css
@src/components/Navigation.tsx
@src/components/ui/Button.tsx
@src/components/ui/Card.tsx
@src/components/ui/Input.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install framer-motion and add page transitions</name>
  <files>
    package.json
    src/App.tsx
  </files>
  <action>
**Install framer-motion:**
- Run `npm install framer-motion`
- This is the only new dependency for Phase 9

**Page transitions in App.tsx:**
- Import `LazyMotion`, `domAnimation`, `m`, `AnimatePresence` from `framer-motion` (LazyMotion for 5kb bundle, NOT full motion import which is 25kb)
- Wrap the app content (inside `<main>`) with `<LazyMotion features={domAnimation}>`
- Wrap tab content with `<AnimatePresence mode="wait">`
- Each tab content section gets wrapped in `<m.div>` with:
  - `key={activeTab}` (triggers animation on tab change)
  - `initial={{ opacity: 0, y: 8 }}` (subtle fade + slight upward shift)
  - `animate={{ opacity: 1, y: 0 }}`
  - `exit={{ opacity: 0, y: -8 }}`
  - `transition={{ duration: 0.15, ease: 'easeOut' }}` (fast, barely perceptible)
- Add `@media (prefers-reduced-motion: reduce)` respect: check `window.matchMedia('(prefers-reduced-motion: reduce)').matches` and skip animations if true (pass `transition={{ duration: 0 }}`)
- Keep all existing functionality (FeatureErrorBoundary wrapping, lazy loading Analytics, etc.)

**App.tsx design token migration:**
- Header: Replace `border-zinc-800` with `border-border-primary`, `text-zinc-500` with `text-text-muted`
- Demo mode warning: Replace amber-specific classes with `bg-warning/10 border-warning/30 text-warning`
- Loading/error states: Use design token classes
- Main content area: Ensure `bg-bg-primary` on root
  </action>
  <verify>
- `npm run build` succeeds (framer-motion installed and bundled)
- `npx tsc --noEmit` passes
- Build output shows framer-motion chunk (check dist/assets for new chunk)
  </verify>
  <done>
- framer-motion installed with LazyMotion optimization (5kb not 25kb)
- Tab switching animates with subtle fade+shift
- Respects prefers-reduced-motion
- App.tsx uses design tokens throughout
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate all screens to design token consistency</name>
  <files>
    src/components/Navigation.tsx
    src/components/GymList.tsx
    src/components/ExerciseList.tsx
    src/components/ExerciseForm.tsx
    src/components/GymForm.tsx
    src/components/DeleteConfirmation.tsx
    src/components/templates/TemplateList.tsx
    src/components/templates/TemplateCard.tsx
    src/components/templates/TemplateBuilder.tsx
    src/components/backup/BackupSettings.tsx
    src/components/backup/BackupReminder.tsx
  </files>
  <action>
Systematically replace hardcoded color classes with design token equivalents across ALL listed components. This is a consistency pass, not a redesign.

**Color mapping (find and replace patterns):**
- `bg-zinc-950` or `bg-zinc-900` backgrounds -> `bg-bg-secondary` (for cards/sections) or `bg-bg-primary` (for page bg)
- `bg-zinc-800` -> `bg-bg-tertiary` (inputs, hover states)
- `bg-zinc-800/50` -> `bg-bg-tertiary/50`
- `bg-zinc-700` hover states -> `hover:bg-bg-tertiary` or keep for subtle differences
- `border-zinc-800` -> `border-border-primary`
- `border-zinc-700` -> `border-border-secondary`
- `text-zinc-100` or `text-white` -> `text-text-primary`
- `text-zinc-300` or `text-zinc-400` -> `text-text-secondary`
- `text-zinc-500` -> `text-text-muted`
- `text-red-400` or `text-red-500` -> `text-error`
- `text-green-400` or `text-green-500` -> `text-success`
- `text-yellow-500` -> `text-warning`
- `bg-red-600` danger buttons -> `bg-error`
- `bg-green-600` success buttons -> `bg-success`

**Navigation.tsx specific:**
- Replace `bg-zinc-900` with `bg-bg-primary`
- Replace `border-zinc-800` with `border-border-primary`
- Replace `text-zinc-500` with `text-text-muted`
- Replace `text-zinc-300` hover with `text-text-secondary`
- Keep `text-accent` and `border-accent` as-is (already using design tokens)

**DeleteConfirmation.tsx:**
- Migrate to use Dialog primitive from `src/components/ui/Dialog.tsx` if it currently uses a custom modal
- Or if it already uses a pattern, just update colors to design tokens

**For each component:**
1. Read the file
2. Find all hardcoded zinc/color classes
3. Replace with design token equivalents
4. Ensure buttons use Button primitive where possible (or at minimum use token classes)
5. Ensure inputs use Input primitive or token classes
6. Do NOT change layout, functionality, or component structure

**Important:** Do NOT touch workout components (SetGrid, SetRow, ActiveWorkout, ExerciseView) -- those are handled in Plans 01 and 02. Only touch the files listed above.
  </action>
  <verify>
- `npx tsc --noEmit` passes
- `npm run build` succeeds
- Grep for remaining raw `zinc-` classes in migrated files: should be minimal (some zinc classes are used for subtle gradients/hover states that don't have direct token equivalents -- that's fine)
  </verify>
  <done>
- All listed components use design tokens for primary colors/borders/text
- Navigation uses token classes
- DeleteConfirmation migrated to Dialog primitive or token classes
- Template screens consistent with workout/analytics screens
- Settings/backup screens consistent
  </done>
</task>

</tasks>

<verification>
- `npm run build` succeeds with framer-motion in bundle
- Tab transitions animate on switch
- Grep shows design token usage across all migrated components
- No visual regressions in layout or functionality
- Build bundle size increase is reasonable (5-10kb for LazyMotion)
</verification>

<success_criteria>
- UI-03: All screens use consistent design token colors, spacing, and typography
- UI-04: Smooth fade+shift transitions between tabs (150ms, respects prefers-reduced-motion)
- framer-motion added with LazyMotion bundle optimization
- Dark, modern aesthetic consistent across all app screens
</success_criteria>

<output>
After completion, create `.planning/phases/09-batch-logging-visual-polish/09-03-SUMMARY.md`
</output>
