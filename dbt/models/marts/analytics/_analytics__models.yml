version: 2

models:
  - name: vw_exercise_history
    description: "Analytical view of recent exercise performance - last 2 weeks with gym and workout context"
    columns:
      - name: set_id
        description: "Unique set identifier"
      - name: workout_id
        description: "Associated workout session ID"
      - name: exercise_id
        description: "Exercise performed (actual, may differ from original due to substitution)"
      - name: original_exercise_id
        description: "Originally planned exercise ID"
      - name: exercise_name
        description: "Exercise name"
      - name: muscle_group
        description: "Primary muscle group targeted"
      - name: is_global
        description: "True if exercise is globally comparable across gyms"
      - name: weight_kg
        description: "Weight lifted in kilograms"
      - name: reps
        description: "Number of repetitions performed"
      - name: rir
        description: "Reps in reserve (null if not tracked)"
      - name: estimated_1rm
        description: "Estimated one-rep max"
      - name: is_pr
        description: "True if this set was a personal record"
      - name: is_anomaly
        description: "True if weight changed 50%+ from previous session"
      - name: weight_change_pct
        description: "Percentage change from previous session weight"
      - name: logged_at
        description: "Timestamp when set was logged"
      - name: workout_started_at
        description: "Workout session start time"
      - name: workout_completed_at
        description: "Workout session completion time (null if in progress)"
      - name: gym_id
        description: "Gym where workout was performed"
      - name: exercise_gym_id
        description: "Gym associated with exercise (null if global)"
      - name: template_id
        description: "Template used for workout (null if custom)"
      - name: _created_at
        description: "Event creation timestamp"

  - name: vw_exercise_progress
    description: "Daily aggregated progress data for exercise charts (last 28 days)"
    columns:
      - name: exercise_id
        description: "Original exercise ID (stable across substitutions)"
      - name: date
        description: "Date of workout"
      - name: max_weight
        description: "Maximum weight lifted that day (kg)"
      - name: max_1rm
        description: "Maximum estimated 1RM that day (kg)"
      - name: total_volume
        description: "Total volume (sum of weight_kg * reps)"
      - name: set_count
        description: "Number of sets performed"
      - name: exercise_name
        description: "Name of the exercise"
      - name: muscle_group
        description: "Primary muscle group"

  - name: vw_weekly_comparison
    description: "Week-over-week comparison metrics for exercise performance"
    columns:
      - name: exercise_id
        description: "Original exercise ID"
      - name: week_start
        description: "Start of the week"
      - name: max_weight
        description: "Maximum weight lifted that week"
      - name: max_1rm
        description: "Maximum estimated 1RM that week"
      - name: total_volume
        description: "Total volume for the week"
      - name: set_count
        description: "Number of sets performed that week"
      - name: prev_max_weight
        description: "Previous week's maximum weight"
      - name: prev_volume
        description: "Previous week's total volume"
      - name: exercise_name
        description: "Name of the exercise"
      - name: muscle_group
        description: "Primary muscle group"
      - name: weight_change_pct
        description: "Percentage change in max weight from previous week"
      - name: volume_change_pct
        description: "Percentage change in volume from previous week"

  - name: vw_volume_by_muscle_group
    description: "Weekly volume aggregation by muscle group (last 4 weeks)"
    columns:
      - name: week_start
        description: "Start of the week (Monday)"
      - name: muscle_group
        description: "Primary muscle group"
      - name: set_count
        description: "Number of sets performed that week for the muscle group"

  - name: vw_muscle_heat_map
    description: "4-week aggregate volume for heat map visualization"
    columns:
      - name: muscle_group
        description: "Primary muscle group"
      - name: total_sets
        description: "Total sets over last 4 weeks"
      - name: first_logged_at
        description: "First set logged in the 4-week period"
      - name: last_logged_at
        description: "Most recent set logged in the 4-week period"
